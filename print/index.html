<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Professional Printing Solution</title>
    <style>
        /* Main page styles */
        .print-link {
            display: inline-block;
            padding: 12px 24px;
            background: #2196F3;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
<a class="print-link" onclick="launchPrintWindow()">Secure Print</a>
<img id="printSource" src="https://www.fineprintart.com/images/blog/starbucks/Starbucks-Logo-1987.svg" >

    <script>

        // Print configuration parameters
        const printConfig = {
            imageUrl: document.getElementById('printSource').src,
            timeout: 10,      // Image loading wait time
            closeDelay: 10    // Close delay after printing
        };




        // Secure print window control
        function launchPrintWindow() {
            try {
                const printWindow = window.open('', '_blank', 'toolbar=0,scrollbars=0');
                
                // Build print document
                const printDoc = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>Print Preview</title>
                        <style>
                            /* Print styles - highest priority */
                            @media print {
                                body, html {
                                    margin: 0 !important;
                                    padding: 0 !important;
                                }
                                img {
                                    width: 100% !important;
                                    height: 100% !important;
                                    object-fit: contain !important;
                                    position: fixed !important;
                                    top: 0 !important;
                                    left: 0 !important;
                                }
                                /* Hide all helper elements */
                                .print-controls, script, style {
                                    display: none !important;
                                    height: 0 !important;
                                    width: 0 !important;
                                }
                            }
                            /* Screen preview styles */
                            @media screen {

                                body {
                                    background: #ffffff;
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                    height: 90vh;
                                }
                                img {
                                    width: 100%;
                                    height: 100%;
                                }
                            }
                        </style>
                    </head>
                    <body>
                        <img src="${printConfig.imageUrl}" 
                             onload="window.__printReady=true">
                        
                        <script>
                            // Auto print controller
                            window.__printReady = false;
                            const checkPrint = setInterval(() => {
                                if (window.__printReady) {
                                    clearInterval(checkPrint);
                                    setTimeout(() => {
                                        window.print();
                                        setTimeout(() => window.close(), ${printConfig.closeDelay});
                                    }, 100);
                                }
                            }, 100);
                        <\/script>
                    </body>
                    </html>
                `;

                // Write and close document stream
                printWindow.document.open();
                printWindow.document.write(printDoc);
                printWindow.document.close();

            } catch (e) {
                alert('Please allow pop-ups to proceed with printing');
                console.error('Print window blocked:', e);
            }
        }
    </script>
</body>
</html>